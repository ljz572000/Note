# 变量与注释

## 1.1 基础知识

### 1.1.1 

变量与注释是作者表达思想的基础，是读者理解代码的第一道门，它们对代码质量的贡献毋庸置疑

#### 01. 变量解包

变量**解包**（unpacking）： 是Python里的一种特殊赋值操作，允许我们把一个可迭代对象（比如列表）的所有成员，一次性赋值给多个变量：

```python
>>> usernames = ['piglei', 'raymond']
# 注意：左侧变量的个数必须和待展开的列表长度相等，否则会报错
>>> author, reader = usernames
>>> author
'piglei'
```

甚至可以一次展开多层嵌套数据：

```python
>>> attrs = [1, ['piglei', 100]]
>>> user_id, (username, score) = attrs
>>> user_id
1
>>> username
'piglei'
```

除了上面的普通解包外，Python还支持更灵活的动态解包语法。

只要用星号表达式（*variables）作为变量名，它便会贪婪地捕获多个值对象，并将捕获到的内容作为列表赋值给variables。

```python
>>> data = ['piglei', 'apple', 'orange', 'banana', 100]
>>> username, *fruits, score = data
>>> username
'piglei'
>>> fruits
['apple', 'orange', 'banana']
>>> score
100
```

和常规的切片赋值语句比起来，动态解包语法要直观许多

上面的变量解包操作也可以在任何循环语句里使用：

```python
>>> for username, score in [('piglei', 100), ('raymond', 60)]:
...     print(username)
...
piglei
raymond
```

#### 02. 单下划线变量名_

在常用的诸多变量名中，单下划线_是比较特殊的一个。

它常作为一个无意义的占位符出现在赋值语句中。

_这个名字本身没什么特别之处，这算是大家约定俗成的一种用法。

```python
#忽略展开时的第二个变量
>>> author, _ = usernames
# 忽略第一个和最后一个变量之间的所有变量
>>> username, *_, score = data
```

### 1.1.2 给变量注明类型

```python
def remove_invalid(items):
    """剔除 items 里面无效的元素"""
    ... ...
```

从上面代码中，我们无法得知，items参数是什么类型。

为了解决动态类型带来的可读性问题，最常见的办法就是在函数文档（docstring）里做文章。我们可以把每个函数参数的类型与说明全都写在函数文档里。

下面是增加了Python官方推荐的Sphinx格式文档后的效果：

```Python
def remove_invalid(items):
    """剔除 items 里面无效的元素

    :param items: 待剔除对象
    :type items: 包含整数的列表，[int, ...]
    """
```

在上面的函数文档里，注明了。任何人只要读到这份文档，马上就能知道参数类型。

当然，标注类型的办法肯定不止上面这一种。

在python 3.5 版本以后，你可以用类型注解功能来直接注明变量类型。

**相比编写Sphinx格式文档，我其实更推荐使用类型注解，因为它是Python内置功能，而且正在变得越来越流行**。

```Python
from typing import List

def remove_invalid(items: List[int]): ➊
    """剔除 items 里面无效的元素"""
    ... ...
```

> List 表示参数为列表类型，`[int]` 表示里面的成员是整型

> "类型注解"只是一种有关类型的注释，不提供任何校验功能。要校验类型正确性，需要使用其他静态类型检查工具（如mypy等）。
>


平心而论，不管是编写Sphinx格式文档，还是添加类型注释，都会增加编写代码的工作量。

同样一段代码，标注变量类型比不标注一定要花费更多时间。

但从我的经验来看，这些额外的时间投入，会带来非常丰厚的回报

- 代码更已读
- 大部分IDE会读取类型注解信息，提供更智能的输入提示；
- 类型注解配合mypy等静态类型检查工具，能提升diamagnetic正确性
